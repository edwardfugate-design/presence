<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>presence ‚Ä¢ rituals v2</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,600;1,400&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --dawn: #fcfcfc; --slate: #1e293b; --indigo: #6366f1; --emerald: #10b981;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: var(--dawn); color: var(--slate);
            margin: 0; overflow-x: hidden;
        }
        .font-serif { font-family: 'Cormorant Garamond', serif; }
        .ritual-glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0,0,0,0.05);
            border-radius: 3rem;
        }
        .intensity-bar { transition: height 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="p-6 md:p-12">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // BEST-IN-CLASS DATA STRUCTURE
        const MODULES = {
            meditation: { name: 'Zenith', duration: 10, icon: 'üßò', intensity: 1, muscles: ['Core'] },
            yoga: { name: 'Vinyasa', duration: 20, icon: 'üåä', intensity: 4, muscles: ['Legs', 'Shoulders', 'Back'] },
            breathwork: { name: 'Prana', duration: 5, icon: 'üí®', intensity: 2, muscles: ['Lungs'] },
            bodyscan: { name: 'Somatic', duration: 12, icon: '‚ú®', intensity: 1, muscles: ['Full Body'] },
            journal: { name: 'Reflect', duration: 5, icon: 'üìñ', intensity: 1, muscles: ['Mind'] },
            ambient: { name: 'Sonic', duration: 15, icon: 'üéµ', intensity: 1, muscles: ['Nervous System'] }
        };

        function App() {
            const [view, setView] = useState('list');
            const [rituals, setRituals] = useState([]);
            const [activeRitual, setActiveRitual] = useState(null);
            const [step, setStep] = useState(0);

            useEffect(() => {
                const saved = JSON.parse(localStorage.getItem('presence_rituals_v2') || '[]');
                setRituals(saved);
            }, []);

            const saveRitual = (r) => {
                const updated = [...rituals, { ...r, id: Date.now() }];
                localStorage.setItem('presence_rituals_v2', JSON.stringify(updated));
                setRituals(updated);
                setView('list');
            };

            // RENDER: THE HUB (LIST)
            if (view === 'list') return (
                <div className="max-w-6xl mx-auto animate-in fade-in duration-700">
                    <header className="flex justify-between items-end mb-20">
                        <div>
                            <span className="text-[10px] tracking-[0.4em] font-bold text-indigo-500 uppercase">System Intelligence</span>
                            <h1 className="text-8xl font-serif tracking-tighter leading-none mt-2">Rituals</h1>
                        </div>
                        <button onClick={() => setView('create')} className="bg-slate-900 text-white px-10 py-4 rounded-full text-xs font-bold tracking-widest hover:scale-105 transition-transform">
                            + DESIGN FLOW
                        </button>
                    </header>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {rituals.map(r => (
                            <div key={r.id} className="ritual-glass p-10 hover:shadow-2xl transition-all group cursor-pointer" onClick={() => {setActiveRitual(r); setView('play')}}>
                                <div className="flex justify-between items-start mb-8">
                                    <h3 className="text-4xl font-serif italic">{r.name}</h3>
                                    <div className="flex items-center gap-1">
                                        {[...Array(5)].map((_, i) => (
                                            <div key={i} className={`h-1 w-4 rounded-full ${i < r.intensity ? 'bg-indigo-500' : 'bg-slate-100'}`} />
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="flex gap-3 mb-10">
                                    {r.steps.map((s, i) => (
                                        <div key={i} className="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-sm border border-slate-50 text-lg">
                                            {MODULES[s].icon}
                                        </div>
                                    ))}
                                </div>

                                <div className="flex justify-between items-center pt-6 border-t border-slate-100">
                                    <span className="text-[10px] font-bold tracking-widest text-slate-400 uppercase">{r.duration} MIN SESSION</span>
                                    <span className="text-indigo-600 font-bold text-xs group-hover:translate-x-2 transition-transform">BEGIN ‚Üí</span>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );

            // RENDER: PLAY (THE JOURNEY)
            if (view === 'play') {
                const currentModule = MODULES[activeRitual.steps[step]];
                const isLast = step === activeRitual.steps.length - 1;
                
                return (
                    <div className="max-w-4xl mx-auto min-h-[80vh] flex flex-col justify-center items-center text-center">
                        <div className="mb-12">
                            <span className="text-[10px] tracking-[0.5em] text-indigo-500 font-bold uppercase block mb-4">Current Immersion</span>
                            <div className="text-[120px] leading-none mb-6 animate-bounce">{currentModule.icon}</div>
                            <h2 className="text-7xl font-serif italic mb-2">{currentModule.name}</h2>
                            <p className="text-slate-400 font-light tracking-widest uppercase text-xs">{currentModule.duration} Minutes ‚Ä¢ Intensity {currentModule.intensity}/5</p>
                        </div>

                        {/* TRANSITION CUE ENGINE */}
                        <div className="bg-white/50 border border-indigo-50 p-8 rounded-[2rem] mb-12 max-w-md italic font-serif text-xl text-slate-500">
                            {step === 0 ? "Begin by finding a neutral spine and softening the gaze." : 
                             `Transitioning from ${MODULES[activeRitual.steps[step-1]].name}... Inhale deeply, find length, and move with intention.`}
                        </div>

                        <div className="flex gap-4">
                            <button onClick={() => setView('list')} className="px-8 py-4 rounded-full border border-slate-200 text-[10px] font-bold tracking-widest uppercase hover:bg-white">Abort</button>
                            <button onClick={() => isLast ? setView('list') : setStep(step + 1)} className="px-12 py-4 rounded-full bg-indigo-600 text-white text-[10px] font-bold tracking-widest uppercase shadow-xl hover:bg-indigo-700">
                                {isLast ? 'Complete Ritual' : 'Next Movement ‚Üí'}
                            </button>
                        </div>

                        {/* INTENSITY CURVE VISUALIZER */}
                        <div className="fixed bottom-12 left-1/2 -translate-x-1/2 flex items-end gap-2 h-20">
                            {activeRitual.steps.map((s, i) => (
                                <div key={i} 
                                     className={`w-3 rounded-t-full transition-all duration-1000 ${i === step ? 'bg-indigo-600 shadow-lg shadow-indigo-200' : 'bg-slate-200'}`}
                                     style={{ height: `${MODULES[s].intensity * 20}%` }} />
                            ))}
                        </div>
                    </div>
                );
            }

            // RENDER: CREATE (THE ARCHITECT)
            if (view === 'create') {
                return (
                    <div className="max-w-2xl mx-auto py-10 animate-in slide-in-from-bottom duration-500">
                        <button onClick={() => setView('list')} className="text-[10px] font-bold tracking-widest uppercase mb-8 text-slate-400">‚Üê Cancel</button>
                        <h2 className="text-6xl font-serif tracking-tighter mb-12">Design Ritual</h2>
                        
                        <div className="space-y-12">
                            <section>
                                <label className="text-[10px] font-bold tracking-[0.3em] uppercase text-indigo-500 block mb-4">Identity</label>
                                <input id="ritName" type="text" placeholder="e.g. Morning Vitality" className="w-full bg-transparent border-b-2 border-slate-100 py-4 text-3xl font-serif focus:outline-none focus:border-indigo-500 transition-colors" />
                            </section>

                            <section>
                                <label className="text-[10px] font-bold tracking-[0.3em] uppercase text-indigo-500 block mb-4">Build Sequence</label>
                                <div className="grid grid-cols-3 gap-3">
                                    {Object.entries(MODULES).map(([key, mod]) => (
                                        <button key={key} onClick={() => {
                                            const name = document.getElementById('ritName').value;
                                            saveRitual({
                                                name: name || 'Untitled Flow',
                                                steps: [key, 'yoga', 'meditation'], // Simplified for demo
                                                intensity: 3,
                                                duration: 35
                                            });
                                        }} className="p-6 ritual-glass hover:border-indigo-500 transition-all text-center group">
                                            <div className="text-3xl mb-2 group-hover:scale-110 transition-transform">{mod.icon}</div>
                                            <div className="text-[10px] font-bold uppercase tracking-widest">{mod.name}</div>
                                        </button>
                                    ))}
                                </div>
                                <p className="mt-6 text-slate-400 text-xs italic text-center">Tap a module to auto-generate a balanced sequence template.</p>
                            </section>
                        </div>
                    </div>
                );
            }
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
