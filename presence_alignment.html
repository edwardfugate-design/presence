<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>presents • alignment lab</title>
    
    <script src="presence-content-manager.js"></script>
    <script src="all-libraries-compact.js"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&family=Instrument+Serif:italic&family=Inter:wght@400;600;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['"Instrument Serif"', 'serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style type="text/css">
        /* Internal CSS to prevent "Failed to load stylesheet" errors */
        body { background-color: #fafafa; color: #1e293b; margin: 0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass-card { 
            background: rgba(255, 255, 255, 0.8); 
            backdrop-filter: blur(16px); 
            border: 1px solid rgba(0,0,0,0.05); 
            border-radius: 3rem;
        }
        .mode-transition { transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1); }
        
        input[type="range"] { 
            -webkit-appearance: none; 
            width: 100%; 
            height: 4px; 
            background: #e2e8f0; 
            border-radius: 2px; 
            outline: none; 
        }
        input[type="range"]::-webkit-slider-thumb { 
            -webkit-appearance: none; 
            width: 18px; 
            height: 18px; 
            background: #1e293b; 
            border-radius: 50%; 
            cursor: pointer; 
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, useMemo } = React;

        function LabApp() {
            const [allPoses, setAllPoses] = useState([]);
            const [selectedId, setSelectedId] = useState(null);
            const [mode, setMode] = useState('structure'); // structure | philosophy
            const [search, setSearch] = useState('');
            const [cat, setCat] = useState('All');

            const categories = ["All", "Standing", "Backbend", "Forward Fold", "Inversion", "Twist", "Hip Opener", "Restorative", "Arm Balance"];

            useEffect(() => {
                const interval = setInterval(() => {
                    const data = window.ALL_POSES || window.POSE_LIBRARY || [];
                    if (data.length > 0) {
                        setAllPoses(data);
                        if (!selectedId) setSelectedId(data[0].id);
                        clearInterval(interval);
                    }
                }, 500);
                return () => clearInterval(interval);
            }, [selectedId]);

            const filtered = useMemo(() => {
                return allPoses.filter(p => {
                    const mSearch = p.name.toLowerCase().includes(search.toLowerCase());
                    const mCat = cat === 'All' || p.category === cat;
                    return mSearch && mCat;
                }).slice(0, 100);
            }, [search, cat, allPoses]);

            const pose = useMemo(() => allPoses.find(p => p.id === selectedId), [selectedId, allPoses]);

            if (!pose) return React.createElement('div', {className: "h-screen flex items-center justify-center font-serif italic text-2xl"}, "Loading Lineage...");

            return React.createElement('div', { 
                className: `min-h-screen border-t-[12px] mode-transition ${mode === 'structure' ? 'border-indigo-500' : 'border-rose-400'}` 
            },
                // HEADER
                React.createElement('nav', { className: "bg-white/90 backdrop-blur-md border-b border-gray-100 p-6 sticky top-0 z-50" },
                    React.createElement('div', { className: "max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6" },
                        React.createElement('div', { className: "flex items-center gap-6" },
                            React.createElement('a', { href: "index.html", className: "text-[10px] font-black tracking-[0.3em] text-gray-300 hover:text-black transition-colors" }, "HUB"),
                            React.createElement('h1', { className: "text-4xl font-serif italic" }, "presents", 
                                React.createElement('span', { className: mode === 'structure' ? 'text-indigo-500' : 'text-rose-400' }, "•"), "lab")
                        ),
                        React.createElement('div', { className: "flex gap-2 p-1.5 bg-gray-100 rounded-full" },
                            React.createElement('button', { 
                                onClick: () => setMode('structure'),
                                className: `px-8 py-2.5 rounded-full text-[10px] font-black uppercase tracking-widest transition-all ${mode === 'structure' ? 'bg-indigo-600 text-white shadow-lg' : 'text-gray-400'}`
                            }, "Structure + Alignment"),
                            React.createElement('button', { 
                                onClick: () => setMode('philosophy'),
                                className: `px-8 py-2.5 rounded-full text-[10px] font-black uppercase tracking-widest transition-all ${mode === 'philosophy' ? 'bg-rose-500 text-white shadow-lg' : 'text-gray-400'}`
                            }, "Heart + Accessibility")
                        )
                    )
                ),

                // MAIN CONTENT
                React.createElement('main', { className: "max-w-7xl mx-auto p-6 md:p-12 flex flex-col lg:flex-row gap-16" },
                    // SEARCH & LIBRARY
                    React.createElement('aside', { className: "w-full lg:w-80 space-y-8" },
                        React.createElement('div', { className: "space-y-4" },
                            React.createElement('input', { 
                                type: "text", placeholder: "Search 500+ poses...", 
                                className: "w-full p-5 rounded-2xl bg-white border border-gray-100 font-serif italic text-xl outline-none shadow-sm focus:ring-2 focus:ring-gray-50",
                                onChange: e => setSearch(e.target.value)
                            }),
                            React.createElement('div', { className: "flex flex-wrap gap-1" },
                                categories.slice(0, 6).map(c => React.createElement('button', {
                                    key: c, onClick: () => setCat(c),
                                    className: `text-[9px] font-black uppercase px-3 py-1 rounded-md border transition-all ${cat === c ? 'bg-black text-white border-black' : 'text-gray-400 border-gray-100 hover:border-gray-300'}`
                                }, c))
                            )
                        ),
                        React.createElement('div', { className: "flex flex-col gap-3 overflow-y-auto h-[55vh] no-scrollbar pr-3 border-r border-gray-50" },
                            filtered.map(p => React.createElement('button', {
                                key: p.id, onClick: () => setSelectedId(p.id),
                                className: `p-6 text-left rounded-[2rem] transition-all group ${selectedId === p.id ? 'bg-white shadow-xl ring-1 ring-gray-100' : 'opacity-40 hover:opacity-100'}`
                            }, 
                                React.createElement('div', {className: `text-[9px] font-bold uppercase mb-1 ${mode === 'structure' ? 'text-indigo-400' : 'text-rose-400'}`}, p.category),
                                React.createElement('div', {className: "text-2xl font-serif group-hover:italic transition-all"}, p.name)
                            ))
                        )
                    ),

                    // ANALYSIS STAGE
                    React.createElement('div', { className: "flex-1 space-y-12" },
                        React.createElement('div', { className: "glass-card p-12 md:p-16 min-h-[500px] relative shadow-2xl shadow-gray-200/50" },
                            React.createElement('div', { className: "mb-16" },
                                React.createElement('span', { className: "text-[10px] font-black uppercase tracking-[0.4em] text-gray-300" }, "Visual Analysis"),
                                React.createElement('h2', { className: "text-7xl font-serif italic tracking-tighter mt-4 text-gray-900" }, pose.name),
                                React.createElement('p', { className: "text-2xl text-gray-400 font-serif italic mt-2" }, pose.sanskrit)
                            ),

                            mode === 'structure' ? 
                                React.createElement('div', { className: "space-y-10 max-w-xl animate-in fade-in slide-in-from-bottom duration-700" },
                                    (pose.checkpoints || []).map(cp => React.createElement('div', { key: cp.joint },
                                        React.createElement('div', { className: "flex justify-between text-[10px] font-black uppercase text-indigo-500 mb-4 tracking-[0.2em]" },
                                            React.createElement('span', null, cp.label),
                                            React.createElement('span', {className: "font-mono text-sm font-normal"}, cp.ideal, "°")
                                        ),
                                        React.createElement('div', { className: "h-1.5 w-full bg-gray-100 rounded-full overflow-hidden" },
                                            React.createElement('div', { 
                                                className: "h-full bg-indigo-500 rounded-full transition-all duration-1000", 
                                                style: { width: `${(cp.ideal / 180) * 100}%` } 
                                            })
                                        )
                                    ))
                                ) :
                                React.createElement('div', { className: "text-center py-12 animate-in fade-in zoom-in duration-1000" },
                                    React.createElement('div', { className: "w-20 h-20 bg-rose-50 rounded-full flex items-center justify-center mx-auto mb-8" },
                                        React.createElement('div', { className: "w-3 h-3 bg-rose-400 rounded-full animate-ping" })
                                    ),
                                    React.createElement('p', { className: "text-4xl font-serif italic text-gray-800 leading-tight" }, 
                                        `"${pose.philosophy || "Soften the edges of the effort to find the center of your peace."}"`
                                    )
                                )
                        ),

                        // INSIGHT GRID
                        React.createElement('div', { className: "grid md:grid-cols-2 gap-8" },
                            React.createElement('div', { className: "bg-gray-900 text-white p-12 rounded-[3rem] shadow-xl" },
                                React.createElement('span', { className: "text-[10px] font-black uppercase tracking-widest opacity-40" }, mode === 'structure' ? "Intelligent Sequence" : "Breath Flow"),
                                React.createElement('p', { className: "mt-6 font-serif italic text-2xl leading-snug" }, 
                                    mode === 'structure' ? (pose.sequencing || "Foundational stability precedes postural expression.") : (pose.breath || "Exhale into the depths of the shape.")
                                )
                            ),
                            React.createElement('div', { className: "bg-white p-12 rounded-[3rem] border border-gray-100 shadow-sm" },
                                React.createElement('span', { className: "text-[10px] font-black uppercase tracking-widest text-gray-400" }, mode === 'structure' ? "Activation Mapping" : "Accessibility"),
                                React.createElement('div', { className: "mt-6 flex flex-wrap gap-2" },
                                    mode === 'structure' ? 
                                        (pose.muscles || []).map(m => React.createElement('span', { key: m, className: "px-4 py-1.5 bg-gray-50 text-[10px] font-black uppercase rounded-lg border border-gray-100 text-gray-500" }, m)) :
                                        React.createElement('p', {className: "text-xl font-serif italic text-gray-500 leading-relaxed"}, pose.accessibility || "Utilize props to bridge the gap between effort and comfort.")
                                )
                            )
                        )
                    )
                )
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(LabApp));
    </script>
</body>
</html>
